{
  "id": "xpath",
  "title": "XPath",
  "intro": "|\nThis is an [XPath](https://en.wikipedia.org/wiki/XPath) selectors cheat sheet, which lists commonly used XPath positioning methods and CSS selectors",
  "tags": [
    "document",
    "expression",
    "select"
  ],
  "categories": [
    "Toolkit"
  ],
  "background": "bg-[#77aeeb]",
  "content": "## XPath Selectors {.cols-6}\n\n### Getting started {.col-span-2}\n\n- [Xpath test bed](http://www.whitebeam.org/library/guide/TechNotes/xpathtestbed.rhtm) _(whitebeam.org)_\n\nTest in Firefox or Chromium based browser console:\n\n```console\n$x('/html/body')\n$x('//h1')\n$x('//h1')[0].innerText\n$x('//a[text()=\"XPath\"]')[0].click()\n```\n\n### Descendant selectors {.col-span-2}\n\n| Xpath        | CSS          |\n| ------------ | ------------ |\n| `//h1`       | h1           |\n| `//div//p`   | div p        |\n| `//ul/li`    | ul > li      |\n| `//ul/li/a`  | ul > li > a  |\n| `//div/*`    | div > \\*     |\n| `/`          | :root        |\n| `/html/body` | :root > body |\n\n{.show-header}\n\n### Order selectors {.col-span-2}\n\n| Xpath               | CSS                  |\n| ------------------- | -------------------- |\n| `//ul/li[1]`        | ul > li:first-child  |\n| `//ul/li[2]`        | ul > li:nth-child(2) |\n| `//ul/li[last()]`   | ul > li:last-child   |\n| `//li[@id=\"id\"][1]` | li#id:first-child    |\n| `//a[1]`            | a:first-child        |\n| `//a[last()]`       | a:last-child         |\n\n{.show-header}\n\n### Attribute selectors {.col-span-3 .row-span-2}\n\n| Xpath                           | CSS                  |\n| ------------------------------- | -------------------- |\n| `//*[@id=\"id\"]`                 | #id                  |\n| `//*[@class=\"class\"]`           | .class               |\n| `//input[@type=\"submit\"]`       | input[type=\"submit\"] |\n| `//a[@id=\"abc\"][@for=\"xyz\"]`    | a#abc[for=\"xyz\"]     |\n| `//a[@rel]`                     | a[rel]               |\n| `//a[starts-with(@href, '/')]`  | a[href^='/']         |\n| `//a[ends-with(@href, '.pdf')]` | a[href$='pdf']       |\n| `//a[contains(@href, '://')]`   | a[href*='`:`//']     |\n| `//a[contains(@rel, 'help')]`   | a[rel~='help']       |\n\n{.show-header}\n\n### Siblings {.col-span-3}\n\n| Xpath                                | CSS      |\n| ------------------------------------ | -------- |\n| `//h1/following-sibling::ul`         | h1 ~ ul  |\n| `//h1/following-sibling::ul[1]`      | h1 + ul  |\n| `//h1/following-sibling::[@id=\"id\"]` | h1 ~ #id |\n\n{.show-header}\n\n### jQuery {.col-span-3}\n\n| Xpath                            | CSS                        |\n| -------------------------------- | -------------------------- |\n| `//ul/li/..`                     | $('ul > li').parent()      |\n| `//li/ancestor-or-self::section` | $('li').closest('section') |\n| `//a/@href`                      | $('a').attr('href')        |\n| `//span/text()`                  | $('span').text()           |\n\n{.show-header}\n\n### Misc selectors {.col-span-3}\n\n| Xpath                             | CSS                       |\n| --------------------------------- | ------------------------- | --------------------- |\n| `//h1[not(@id)]`                  | h1:not([id])              |\n| `//button[text()=\"Submit\"]`       | Text match                |\n| `//button[contains(text(),\"Go\")]` | Text contains (substring) |\n| `//product[@price > 2.50]`        | Arithmetic                |\n| `//ul[*]`                         | Has children              |\n| `//ul[li]`                        | Has children (specific)   |\n| `//a[@name or @href]`             | Or logic                  |\n| `//a                              | //div`                    | Union (joins results) |\n\n{.show-header}\n\n## XPath Expressions\n\n### Steps and axes {.secondary}\n\n<br/>\n\n| -    | -    | -    | -               |\n| ---- | ---- | ---- | --------------- |\n| `//` | `ul` | `/`  | `a[@id='link']` |\n| Axis | Step | Axis | Step            |\n\n{.left-text}\n\n### Prefixes\n\n| Prefix | Example               | Means    |\n| ------ | --------------------- | -------- |\n| `//`   | `//hr[@class='edge']` | Anywhere |\n| `/`    | `/html/body/div`      | Root     |\n| `./`   | `./div/p`             | Relative |\n\n{.show-header}\n\n### Axes\n\n| Axis | Example             | Means      |\n| ---- | ------------------- | ---------- |\n| `/`  | `//ul/li/a`         | Child      |\n| `//` | `//[@id=\"list\"]//a` | Descendant |\n\n{.show-header}\n\n## XPath Predicates\n\n### Predicates\n\n```bash\n//div[true()]\n//div[@class=\"head\"]\n//div[@class=\"head\"][@id=\"top\"]\n```\n\nRestricts a nodeset only if some condition is true. They can be chained.\n\n### Operators\n\n```bash\n# Comparison\n//a[@id = \"xyz\"]\n//a[@id != \"xyz\"]\n//a[@price > 25]\n```\n\n```bash\n# Logic (and/or)\n//div[@id=\"head\" and position()=2]\n//div[(x and y) or not(z)]\n```\n\n### Using nodes\n\n```bash\n# Use them inside functions\n//ul[count(li) > 2]\n//ul[count(li[@class='hide']) > 0]\n```\n\n```bash\n# Returns `<ul>` that has a `<li>` child\n//ul[li]\n```\n\nYou can use nodes inside predicates.\n\n### Indexing\n\n```bash\n//a[1]                # first <a>\n//a[last()]           # last <a>\n//ol/li[2]            # second <li>\n//ol/li[position()=2] # same as above\n//ol/li[position()>1] #:not(:first-child)\n```\n\nUse `[]` with a number, or `last()` or `position()`.\n\n### Chaining order\n\n```bash\na[1][@href='/']\na[@href='/'][1]\n```\n\nOrder is significant, these two are different.\n\n### Nesting predicates\n\n```\n//section[.//h1[@id='hi']]\n```\n\nThis returns `<section>` if it has an `<h1>` descendant with `id='hi'`.\n\n## XPath Functions {.cols-2}\n\n### Node functions\n\n```bash\nname()            # //[starts-with(name(), 'h')]\ntext()            # //button[text()=\"Submit\"]\n                  # //button/text()\nlang(str)\nnamespace-uri()\n```\n\n```bash\ncount()           # //table[count(tr)=1]\nposition()        # //ol/li[position()=2]\n```\n\n### String functions\n\n```bash\ncontains()        # font[contains(@class,\"head\")]\nstarts-with()     # font[starts-with(@class,\"head\")]\nends-with()       # font[ends-with(@class,\"head\")]\n```\n\n```bash\nconcat(x,y)\nsubstring(str, start, len)\nsubstring-before(\"01/02\", \"/\")  #=> 01\nsubstring-after(\"01/02\", \"/\")   #=> 02\ntranslate()\nnormalize-space()\nstring-length()\n```\n\n### Boolean functions\n\n```bash\nnot(expr)         # button[not(starts-with(text(),\"Submit\"))]\n```\n\n### Type conversion\n\n```bash\nstring()\nnumber()\nboolean()\n```\n\n## XPath Axes {.cols-2}\n\n### Using axes\n\n```bash\n//ul/li                       # ul > li\n//ul/child::li                # ul > li (same)\n//ul/following-sibling::li    # ul ~ li\n//ul/descendant-or-self::li   # ul li\n//ul/ancestor-or-self::li     # $('ul').closest('li')\n```\n\n---\n\n|      |      |            |      |\n| ---- | ---- | ---------- | ---- |\n| `//` | `ul` | `/child::` | `li` |\n| Axis | Step | Axis       | Step |\n\n{.left-text}\n\nSteps of an expression are separated by `/`, usually used to pick child nodes. That's not always true: you can specify a\ndifferent \"axis\" with `::`.\n\n### Child axis\n\n```bash\n# both the same\n//ul/li/a\n//child::ul/child::li/child::a\n```\n\n`child::` is the default axis. This makes `//a/b/c` work.\n\n```bash\n# both the same\n# this works because `child::li` is truthy\n//ul[li]\n//ul[child::li]\n```\n\n```bash\n# both the same\n//ul[count(li) > 2]\n//ul[count(child::li) > 2]\n```\n\n### Descendant-or-self axis\n\n```bash\n# both the same\n//div//h4\n//div/descendant-or-self::h4\n```\n\n`//` is short for the `descendant-or-self::` axis.\n\n```bash\n# both the same\n//ul//[last()]\n//ul/descendant-or-self::[last()]\n```\n\n### Other axes {.row-span-2}\n\n| Axis                 | Abbrev | Notes                                            |\n| -------------------- | ------ | ------------------------------------------------ |\n| `ancestor`           |        |                                                  |\n| `ancestor-or-self`   |        |                                                  |\n| `attribute`          | `@`    | `@href` is short for `attribute::href`           |\n| `child`              |        | `div` is short for `child::div`                  |\n| `descendant`         |        |                                                  |\n| `descendant-or-self` | `//`   | `//` is short for `/descendant-or-self::node()/` |\n| `namespace`          |        |                                                  |\n| `self`               | `.`    | `.` is short for `self::node()`                  |\n| `parent`             | `..`   | `..` is short for `parent::node()`               |\n| `following`          |        |                                                  |\n| `following-sibling`  |        |                                                  |\n| `preceding`          |        |                                                  |\n| `preceding-sibling`  |        |                                                  |\n\n{.headers}\n\nThere are other axes you can use.\n\n### Unions\n\n```bash\n//a | //span\n```\n\nUse `|` to join two expressions.\n\n## XPath More examples {.cols-2}\n\n### Examples\n\n```bash\n//*                 # all elements\ncount(//*)          # count all elements\n(//h1)[1]/text()    # text of the first h1 heading\n//li[span]          # find a <li> with an <span> inside it\n                    # ...expands to //li[child::span]\n//ul/li/..          # use .. to select a parent\n```\n\n### Find a parent\n\n```bash\n//section[h1[@id='section-name']]\n```\n\nFinds a `<section>` that directly contains `h1#section-name`\n\n```bash\n//section[//h1[@id='section-name']]\n```\n\nFinds a `<section>` that contains `h1#section-name`. (Same as above, but uses descendant-or-self instead of child)\n\n### Closest\n\n```bash\n./ancestor-or-self::[@class=\"box\"]\n```\n\nWorks like jQuery's `$().closest('.box')`.\n\n### Attributes\n\n```bash\n//item[@price > 2*@discount]\n```\n\nFinds `<item>` and check its attributes\n\n## Also see\n\n- [Devhints](https://devhints.io/xpath) _(devhints.io)_\n- [Xpath test bed](http://www.whitebeam.org/library/guide/TechNotes/xpathtestbed.rhtm) _(whitebeam.org)_\n"
}