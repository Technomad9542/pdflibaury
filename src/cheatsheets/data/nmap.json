{
  "id": "nmap",
  "title": "Nmap",
  "intro": "The [Nmap](https://nmap.org/) cheat sheet is a one-page reference sheet for the famous Network Mapper tool.",
  "tags": [
    "network",
    "scan",
    "port"
  ],
  "categories": [
    "Linux Command"
  ],
  "background": "bg-[#2a0d45]",
  "content": "## Getting Started\r\n\r\n\r\n### Basic Usage : \r\n\r\n```bash\r\n# set your target in etc/hosts\r\n\r\n# fast scan of all port of your target\r\nnmap -p- -T5 target \r\n\r\n# fast scan on port 80 with os detection  \r\nnamp -p, 80 -T5 -O target \r\n```\r\n\r\n\r\n### Basic Options : {.col-span-2}\r\n\r\n| Options                  | Purpose                                   |\r\n|:-------------------------|:------------------------------------------|\r\n| `-p-`                    | all ports                                 |\r\n| `-p1-1023`               | scan ports 1 to 1023                      |\r\n| `-F`                     | 100 most common ports                     |\r\n| `-r`                     | scan ports in consecutive order           |\r\n| `-T<0-5>`                | -T0 being the slowest and T5 the fastest  |\r\n| `--max-rate 50`          | rate <= 50 packets/sec                    |\r\n| `--min-rate 15`          | rate >= 15 packets/sec                    |\r\n| `--min-parallelism 100`  | at least 100 probes in parallel           |\r\n\r\n## Nmap Intermediate Options\r\n\r\n### Service Detections : {.col-span-2}\r\n\r\n| Option                       | Meaning                                  |\r\n|:-----------------------------|:-----------------------------------------|\r\n| `--traceroute`               | run traceroute to target                 |\r\n| `--script=SCRIPTS`           | Nmap scripts to run                      |\r\n| `-sC` or `--script=default`  | run default scripts                      |\r\n| `-O`                         | OS detection                             |\r\n| `-sV`                        | Service version detection                |\r\n| `-A`                         | equivalent to `-sV -O -sC --traceroute`  |\r\n\r\n\r\n### Timing  {.col-span-3}\r\n\r\n| Option                                                              | Meaning                                                                                            |\r\n|:--------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------|\r\n| `-T<0-5>`                                                           | Timing template â€“ paranoid (0), sneaky (1), polite (2), normal (3), aggressive (4), and insane (5) |\r\n| `--min-parallelism <numprobes>` and `--max-parallelism <numprobes>` | Minimum and maximum number of parallel probes                                                      |\r\n| `--min-rate <number>` and `--max-rate <number>`                     | Minimum and maximum rate (packets/second)                                                          |\r\n| `--host-timeout`                                                    | Maximum amount of time to wait for a target host                                                   |\r\n\r\n## Formating answers\r\n\r\n### Details & Report {.col-span-2}\r\n\r\n| Option            | Purpose                                |\r\n|:------------------|:---------------------------------------|\r\n| `--reason`        | explains how Nmap made its conclusion  |\r\n| `-v`              | verbose                                |\r\n| `-vv`             | very verbose                           |\r\n| `-d`              | debugging                              |\r\n| `-dd`             | more details for debugging             |\r\n| `-oN <filename>`  | Normal output                          |\r\n| `-oX <filename>`  | XML output                             |\r\n| `-oG <filename>`  | `grep`-able output                     |\r\n| `-oA <basename>`  | Output in all major formats            |\r\n\r\n## Advanced Technic\r\n\r\n### Advanced Scan {.col-span-3}\r\n\r\n| Options    | Protocol | Main Function     | Typical Use Case                               |\r\n|------------|:---------|:------------------|:-----------------------------------------------|\r\n| `-PR -sn`  | **ARP**  | Scan              | Discovering devices on the local network (LAN) |\r\n| `-PE -sn`  | **ICMP** | Echo Scan         | Checking if hosts are reachable (pinging)      |\r\n| `-PP -sn`  | **ICMP** | Timestamp Scan    | Gathering device time info (less common)       |\r\n| `-PM -sn`  | **ICMP** | Address Mask Scan | Determining subnet mask info from hosts        |\r\n| `-PS -sn`  | **TCP**  | SYN Ping Scan     | Detecting open TCP ports and live hosts        |\r\n| `-PA -sn ` | **TCP**  | ACK Ping Scan     | Identifying firewall rules and open ports      |\r\n| `-PU -sn`  | **ICMP** | Ping Scan         | Finding hosts with open UDP services           |\r\n\r\n\r\n##  Investigation Exemple \r\n\r\n### Verbose Os Quick port scan {.col-span-3}\r\n\r\n```bash\r\nnmap -sV -O -p- -T5 target \r\n \r\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-02 15:17 CET\r\n\r\nNmap scan report for target (10.10.158.161)\r\nHost is up (0.021s latency).\r\nNot shown: 65532 closed tcp ports (reset)\r\n\r\nPORT     STATE SERVICE VERSION\r\n22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\r\n8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)\r\n8080/tcp open  http    Apache Tomcat 8.5.5\r\n\r\nAggressive OS guesses: Linux 3.10 - 3.13 (95%), Linux 5.4 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%),\r\nLinux 3.16 (95%), Linux 3.1 (93%), Linux 3.2 (93%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (93%), \r\nSony Android TV (Android 5.0) (93%), Android 5.0 - 6.0.1 (Linux 3.4) (93%), Android 5.1 (93%)\r\nNo exact OS matches for host (test conditions non-ideal).\r\nNetwork Distance: 2 hops\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\r\n\r\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\r\nNmap done: 1 IP address (1 host up) scanned in 39.94 seconds\r\n\r\n\r\n# you can then use `nmap -A -p 22, 8009, 8080 target` on discovered ports\r\n```\r\nDo not use this tool without consent. For educational purposes, this example is coming from a Try Hack Me [machine](https://tryhackme.com/room/bsidesgtthompson).\r\n\r\n\r\n\r\n## Also See\r\n\r\n- [Nmap](https://nmap.org/)"
}